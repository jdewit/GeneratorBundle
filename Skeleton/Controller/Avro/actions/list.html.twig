    /**
     * Show all {{ entity }}s.
     *
     * @Route("/list/{filter}", name="{{ bundle_alias }}_{{ entity_cc }}_list", defaults={"filter" = "All"})
     * @Template()     
     */
    public function listAction($filter)
    {
        $form = $this->container->get('avro_crm.clientSearch.form');
        $request = $this->container->get('request');
        $form->bindRequest($request);

        if ('POST' == $this->container->get('request')->getMethod()) {
            if ($form->isValid()) {
                switch($request->request->get('action')) {
                    case 'Edit':
                        $selected = $request->request->get('selected');
                        $session = $request->getSession();
                        $session->set('queue', array('route' => '{{ bundle_alias }}_{{ entity_cc }}_edit', 'ids' => $selected));

                        return new RedirectResponse($this->container->get('router')->generate('{{ bundle_alias }}_{{ entity_cc }}_edit', array('id' => reset($selected))));
                    break;
                    case 'Export':
                        ${{ entity_cc }}Manager = $this->container->get('{{ bundle_alias }}.{{ entity_cc }}_manager');
                        $writer = $this->container->get('avro_csv.writer');
                        $selected = $request->request->get('selected');
                        foreach ($selected as $id) {
                            ${{ entity_cc }} = ${{ entity_cc }}Manager->findAsArray($id);
                            if ($id === reset($selected)) {
                                $content = $writer->convertRow(array_keys(${{ entity_cc }}));
                            }

                            $content .= $writer->convertRow(array_values(${{ entity_cc }}));
                        }
                        $response = new Response($content);
                        $response->headers->set('Content-Type', 'application/csv');
                        $response->headers->set('Content-Disposition', 'attachment; filename="{{ entity_cc }}.csv"');

                        return $response; 
                    break;
                    default:
                        ${{ entity_cc }}s = $this->container->get('{{ bundle_alias }}.{{ entity_cc }}_manager')->search($form->getData());
                    break;
                }
            }
        } else {
            ${{ entity_cc }}s = $this->container->get('{{ bundle_alias }}.{{ entity_cc }}_manager')->search();
        }

        return array(
            '{{ entity_cc }}s' => ${{ entity_cc }}s,
            'form' => $form->createView(),
            'filter' => $filter
        );
    }    
